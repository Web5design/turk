<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Configuring Turk &mdash; Turk v0.1.1 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '#',
        VERSION:     '0.1.1',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="Turk v0.1.1 documentation" href="index.html" />
    <link rel="next" title="Driver Connectivity" href="driver_connectivity.html" />
    <link rel="prev" title="Getting started with the Turk Framework" href="getting_started.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="driver_connectivity.html" title="Driver Connectivity"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="getting_started.html" title="Getting started with the Turk Framework"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Turk v0.1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="configuring-turk">
<h1>Configuring Turk<a class="headerlink" href="#configuring-turk" title="Permalink to this headline">¶</a></h1>
<div class="section" id="setting-up-drivers">
<h2>Setting up Drivers<a class="headerlink" href="#setting-up-drivers" title="Permalink to this headline">¶</a></h2>
<p>The Turk configuration file is designed to allow for maximum flexibility when
running drivers. Driver processes can actually be launched separately from the
other services and still function perfectly fine; the Spawner service just
makes this much simpler by both managing the drivers and passing them
information about the rest of the framework. Executables can be passed
information in two ways, command-line arguments and environment variables. These
are specified in the driver&#8217;s configuration entry in the &#8220;args&#8221; and &#8220;env&#8221;
settings.</p>
<div class="section" id="which-is-better">
<h3>Which is better?<a class="headerlink" href="#which-is-better" title="Permalink to this headline">¶</a></h3>
<p>It is recommended to use environment variables to pass anything other than a
variable-length list of data (e.g. a list of RSS feeds that a driver will fetch)
to a Turk driver. They are much simpler to fetch and parse in most programming
languages, and tend not to suffer from as many formatting and semantic errors as
command-line arguments. Command-line arguments are difficult to use because they
are essentially a list of words passed to the program that need to have some
kind of meaning assigned to them. They require strict checking to make sure
invalid input is not accepted by the program. Environment variables, on the
other hand, are keyed by name, making them ideal for passing settings and simple
variables to a program. An example of this in the real world can be found in the
CGI standard, which used environment variables to pass information from web
requests to server scripts. Although somewhat outdated, this standard was the
most common way of producing dynamic content on the web for a long time.</p>
</div>
<div class="section" id="unique-identifiers">
<h3>Unique Identifiers<a class="headerlink" href="#unique-identifiers" title="Permalink to this headline">¶</a></h3>
<p>The other important consideration for launching a set of drivers is the Device
ID. This number uniquely identifies a driver instance on a platform, and can be
used to ensure that a driver is not started twice by accident. The ID is
represented as a 64 bit (8 bytes) unsigned integer, which means there are
virtually unlimited numbers of Turk devices on one platform. One recommended
practice is for the driver to claim a D-Bus service name that includes the ID
somehow on startup. The D-Bus daemon will automatically enforce the requirement
that these names be unique, and the driver can gracefully shut down instead of
causing potential problems to an existing driver process.</p>
<p>An example of this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">dbus</span><span class="o">,</span> <span class="nn">os</span>

<span class="c"># The device ID is passed automatically as an environment variable</span>
<span class="n">device_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s">&#39;DEVICE_ID&#39;</span><span class="p">))</span>

<span class="c"># Get the Session or System bus</span>
<span class="n">bus</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">dbus</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s">&#39;BUS&#39;</span><span class="p">))()</span>

<span class="c"># Register an object</span>
<span class="n">dbus</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">Object</span><span class="p">(</span><span class="n">bus</span><span class="p">,</span> <span class="s">&#39;/Drivers/MyDriver/</span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">device_id</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="the-driver-list">
<h2>The Driver List<a class="headerlink" href="#the-driver-list" title="Permalink to this headline">¶</a></h2>
<p>Drivers are typically started in the order they appear in the configuration
file, after a brief delay to ensure that the rest of the Turk services are
running. Since many programs have a short delay before becoming fully
operational, it is probably a good idea to carefully consider the order in which
the drivers are started. If a service, either from a lower-level plugin or just
another driver, is not available, the program must be able to handle this
gracefully. A reasonably effective way of handling this is to keep trying to
access the required services, with a short delay every time to avoid slowing
down the entire system.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># Started first, since wall_display and robot_arm communicate with it</span>
<span class="o">{</span><span class="s1">&#39;device_id&#39;</span>: 1, <span class="s1">&#39;filename&#39;</span>: <span class="s1">&#39;remote_control&#39;</span>, <span class="s1">&#39;env&#39;</span>: <span class="o">{}</span>, <span class="s1">&#39;args&#39;</span>: <span class="o">[]}</span>,

<span class="c"># Order doesn&#39;t matter for these, since they don&#39;t connect at all</span>
<span class="o">{</span><span class="s1">&#39;device_id&#39;</span>: 2, <span class="s1">&#39;filename&#39;</span>: <span class="s1">&#39;wall_display&#39;</span>, <span class="s1">&#39;env&#39;</span>:<span class="o">{</span><span class="s1">&#39;DEVICE_ADDRESS&#39;</span>:<span class="s1">&#39;0x13A2004052DADD&#39;</span><span class="o">}</span>, <span class="s1">&#39;args&#39;</span>: <span class="o">[]}</span>,
<span class="o">{</span><span class="s1">&#39;device_id&#39;</span>: 3, <span class="s1">&#39;filename&#39;</span>: <span class="s1">&#39;robot_arm&#39;</span>, <span class="s1">&#39;env&#39;</span>:<span class="o">{</span><span class="s1">&#39;DEVICE_ADDRESS&#39;</span>:<span class="s1">&#39;0x13A2004052DA9A&#39;</span><span class="o">}</span>, <span class="s1">&#39;args&#39;</span>: <span class="o">[]}</span>,
</pre></div>
</div>
</div>
<div class="section" id="all-settings">
<h2>All Settings<a class="headerlink" href="#all-settings" title="Permalink to this headline">¶</a></h2>
<p>The following is a list of all the possible settings currently available in the
Turk configuration file. Most of these settings are reasonably permanent, and
can be relied on by developers to stay the same. Experimental features will be
usable in various releases of the framework, but may disappear or change
significantly, so use them at your own risk.</p>
<ul>
<li><dl class="first docutils">
<dt>global: These settings apply to all services</dt>
<dd><ul class="first last simple">
<li>bus: The D-Bus bus that all services and drivers connect to (SessionBus or
SystemBus)</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>turkctl: Options for the Turk launcher utility</dt>
<dd><ul class="first last simple">
<li>pidfile: A file used to store the process ID of the main Turk process.
turkctl uses this to stop/start the framework.</li>
<li>debug: Controls the amount of information when running this utility</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>bridge: Options for XMPP communication</dt>
<dd><ul class="first last simple">
<li>server: macpro.local</li>
<li>port: 5222</li>
<li>username: <a class="reference external" href="mailto:platform&#37;&#52;&#48;macpro&#46;local">platform<span>&#64;</span>macpro<span>&#46;</span>local</a></li>
<li>password: password</li>
<li>debug: Set to True to log additional information about XMPP messages</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>spawner: Options for driver spawning and management</dt>
<dd><ul class="first last simple">
<li>autostart: [</li>
<li>drivers: /usr/share/turk/drivers</li>
<li>debug: Set to True to see additional information about drivers being
started and stopped.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>xbeed: Options for XBee radio interface. Leave this section out to disable, if you aren&#8217;t using one.</dt>
<dd><ul class="first last simple">
<li>name: The name of this daemon. Used by drivers to contact this specific
instance. May be used to allow multiple instances of this service in the
future.</li>
<li>port: The serial port that the radio module is connected to (e.g.
/dev/ttyS0)</li>
<li>baudrate: The baudrate the radio is configured at (e.g. 9600)</li>
<li>escaping: Set to True if this module has the escaping option on (see
manual for more details)</li>
<li>debug: Set to True to see additional information about XBee communication</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="#">Configuring Turk</a><ul>
<li><a class="reference external" href="#setting-up-drivers">Setting up Drivers</a><ul>
<li><a class="reference external" href="#which-is-better">Which is better?</a></li>
<li><a class="reference external" href="#unique-identifiers">Unique Identifiers</a></li>
</ul>
</li>
<li><a class="reference external" href="#the-driver-list">The Driver List</a></li>
<li><a class="reference external" href="#all-settings">All Settings</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="getting_started.html"
                                  title="previous chapter">Getting started with the Turk Framework</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="driver_connectivity.html"
                                  title="next chapter">Driver Connectivity</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/configuration.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="driver_connectivity.html" title="Driver Connectivity"
             >next</a> |</li>
        <li class="right" >
          <a href="getting_started.html" title="Getting started with the Turk Framework"
             >previous</a> |</li>
        <li><a href="index.html">Turk v0.1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2010, Rob O&#39;Dwyer.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.4.
    </div>
  </body>
</html>