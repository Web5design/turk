<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Driver Connectivity &mdash; Turk v0.1.1 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '#',
        VERSION:     '0.1.1',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="Turk v0.1.1 documentation" href="index.html" />
    <link rel="next" title="Designing Web Interfaces" href="web_interfaces.html" />
    <link rel="prev" title="Configuring Turk" href="configuration.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="web_interfaces.html" title="Designing Web Interfaces"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="configuration.html" title="Configuring Turk"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Turk v0.1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="driver-connectivity">
<h1>Driver Connectivity<a class="headerlink" href="#driver-connectivity" title="Permalink to this headline">¶</a></h1>
<div class="section" id="advanced-driver-design">
<span id="driver-design"></span><h2>Advanced Driver Design<a class="headerlink" href="#advanced-driver-design" title="Permalink to this headline">¶</a></h2>
<p>The examples of simple drivers given in the <em class="xref">getting_started</em> section are
effective for establishing simple communication between a device or service and
a web application, but have some major limitations. Due to the latency of the
Internet and various other factors, there is an upper limit on the speed at
which messages between drivers and applications can be sent. However, there are
many workarounds for this limitation. Messages from applications are primarily
meant to be used to update the current state of a driver, not to stream large
amounts of real-time data. With this in mind, the ideal way is to instruct the
driver to connect independently to a server, by giving it the
necessary details in a message.</p>
<p>Sending data between two drivers with the application as the intermediary is
another problem. Although the simplest way to do this is to relay the data
through the application and back down to the driver, this is far from ideal. If
there is minimal translation of the data involved, the drivers should be able to
communicate directly with each other.</p>
</div>
<div class="section" id="interconnecting-drivers-and-apps">
<h2>Interconnecting Drivers and Apps<a class="headerlink" href="#interconnecting-drivers-and-apps" title="Permalink to this headline">¶</a></h2>
<p>A basic outline of the process of connecting a driver to an external service is
as follows, using RSS feeds as a simple example of an web service.</p>
<ul class="simple">
<li>Application registers to updates from driver:</li>
</ul>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;message</span> <span class="na">xmlns=</span><span class="s">&quot;jabber:client&quot;</span> <span class="na">to=</span><span class="s">&quot;turk-platform-account@xmpp-server.tld&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;register</span> <span class="na">xmlns=</span><span class="s">&quot;http://turkinnovations.com/protocol&quot;</span> <span class="na">app=</span><span class="s">&quot;2&quot;</span> <span class="na">url=</span><span class="s">&quot;http://example.com/updates/&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;driver</span> <span class="na">id=</span><span class="s">&quot;8&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/register&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li>User adds a new feed to be monitored to application</li>
<li>Application notifies driver that it should start checking a new feed:</li>
</ul>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;message</span> <span class="na">xmlns=</span><span class="s">&quot;jabber:client&quot;</span> <span class="na">to=</span><span class="s">&quot;turk-platform-account@xmpp-server.tld&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;update</span> <span class="na">xmlns=</span><span class="s">&quot;http://turkinnovations.com/protocol&quot;</span> <span class="na">to=</span><span class="s">&quot;100&quot;</span> <span class="na">from=</span><span class="s">&quot;101&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;feed</span> <span class="na">type=</span><span class="s">&quot;atom&quot;</span> <span class="na">update=</span><span class="s">&quot;1min&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;title&gt;</span>Digg News<span class="nt">&lt;/title&gt;</span>
            <span class="nt">&lt;url&gt;</span>http://feeds.digg.com/digg/news/popular.rss<span class="nt">&lt;/url&gt;</span>
        <span class="nt">&lt;/feed&gt;</span>
    <span class="nt">&lt;/update&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li>Driver starts fetching the RSS content from the URL every 1 minute</li>
<li>When a new story is found, the driver sends out an update addressed to the
app:</li>
</ul>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;message</span> <span class="na">xmlns=</span><span class="s">&quot;jabber:client&quot;</span> <span class="na">to=</span><span class="s">&quot;turk-platform-account@xmpp-server.tld&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;update</span> <span class="na">xmlns=</span><span class="s">&quot;http://turkinnovations.com/protocol&quot;</span> <span class="na">to=</span><span class="s">&quot;101&quot;</span> <span class="na">from=</span><span class="s">&quot;100&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;story</span> <span class="na">type=</span><span class="s">&quot;atom&quot;</span> <span class="na">date=</span><span class="s">&quot;1273212547&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;title&gt;</span>Baboon attacks Prime Minister! Nation in panic.<span class="nt">&lt;title&gt;</span>
        <span class="nt">&lt;author&gt;</span>Lois Lane<span class="nt">&lt;/author&gt;</span>
        <span class="nt">&lt;/story&gt;</span>
    <span class="nt">&lt;/update&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</pre></div>
</div>
<p>Connecting two drivers together is even simpler, as all that is needed is a
D-Bus address and path. This allows one driver to make RPC calls to the other,
without going through the overhead of the XMPP handlers and the internet
communication.</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;message</span> <span class="na">xmlns=</span><span class="s">&quot;jabber:client&quot;</span> <span class="na">to=</span><span class="s">&quot;turk-platform-account@xmpp-server.tld&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;update</span> <span class="na">xmlns=</span><span class="s">&quot;http://turkinnovations.com/protocol&quot;</span> <span class="na">to=</span><span class="s">&quot;101&quot;</span> <span class="na">from=</span><span class="s">&quot;100&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;driver</span> <span class="na">type=</span><span class="s">&quot;dbus&quot;</span> <span class="na">method=</span><span class="s">&quot;Update&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;address&gt;</span>org.turkinnovations.exampledriver<span class="nt">&lt;/address&gt;</span>
            <span class="nt">&lt;path&gt;</span>/Drivers/ExampleDriver/42<span class="nt">&lt;/path&gt;</span>
        <span class="nt">&lt;/driver&gt;</span>
    <span class="nt">&lt;/update&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="driver-dependencies">
<h2>Driver Dependencies<a class="headerlink" href="#driver-dependencies" title="Permalink to this headline">¶</a></h2>
<p>A common issue with setting up a Turk system arises when drivers are dependent
on each other to run properly. Drivers can be reused as services to maximize
their capabilities, and can also be connected directly to each other for more
efficient communication. However, there are several important things to keep in
mind when implementing a system like this.</p>
<p>Another issue that can arise with dependencies is fault tolerance.
Unfortunately, even the best drivers can have software bugs, and occasionally,
they crash. The framework is designed to deal with this, however, and will
automatically restart a driver when it detects a problem like this, unless
configured otherwise. However, other drivers must be able to handle any
connections being dropped or data lost in the process. Depending on the method
of communication used, other drivers may need to re-open the connection when the
program at the other end is restarted. DBus proxy connections, for example, are
based on the unique name of the connection. This means that if a driver was
using a reference to another driver, received from a controlling application, that
reference would be useless once the other driver was restarted. The same principle
as before applies to this situation - the driver has to monitor the connection,
and take steps to fix any communication problems when they occur.</p>
</div>
<div class="section" id="running-drivers-on-demand">
<h2>Running Drivers on Demand<a class="headerlink" href="#running-drivers-on-demand" title="Permalink to this headline">¶</a></h2>
<p>The simplest way to make sure a required driver is running is to include in the
configuration file and restart the framework. However, there are some use cases
for starting and stopping drivers on the fly. Examples of these are:</p>
<ul class="simple">
<li>Multi-driver systems that can turn off certain features when not in use</li>
<li>Utility drivers that other drivers can start up when needed</li>
<li>Controlling the Turk Framework from a graphical user interface</li>
</ul>
<p>As a result, there is a way to do this through the Turk API. The API calls
StartDriverByName, RestartDriverByID, StopDriverByID and GetDriverList can be
used to control the Spawner component. This allows drivers and plugins to be
written that can dynamically control the list of drivers currently being managed
by the framework.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="#">Driver Connectivity</a><ul>
<li><a class="reference external" href="#advanced-driver-design">Advanced Driver Design</a></li>
<li><a class="reference external" href="#interconnecting-drivers-and-apps">Interconnecting Drivers and Apps</a></li>
<li><a class="reference external" href="#driver-dependencies">Driver Dependencies</a></li>
<li><a class="reference external" href="#running-drivers-on-demand">Running Drivers on Demand</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="configuration.html"
                                  title="previous chapter">Configuring Turk</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="web_interfaces.html"
                                  title="next chapter">Designing Web Interfaces</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/driver_connectivity.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="web_interfaces.html" title="Designing Web Interfaces"
             >next</a> |</li>
        <li class="right" >
          <a href="configuration.html" title="Configuring Turk"
             >previous</a> |</li>
        <li><a href="index.html">Turk v0.1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2010, Rob O&#39;Dwyer.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.4.
    </div>
  </body>
</html>